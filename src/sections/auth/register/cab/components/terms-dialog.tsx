"use client";

import { useState, useRef } from "react";
import { Button } from "@/components/ui/button";
import {
  Dialog,
  DialogTrigger,
  DialogContent,
  DialogHeader,
  DialogTitle,
  DialogDescription,
  DialogFooter,
} from "@/components/ui/dialog";

type Props = {
  onAccept: () => void; // setValue('terms', true) дамжуулна
};

export default function TermsDialog({ onAccept }: Props) {
  const [open, setOpen] = useState(false);
  const [canAccept, setCanAccept] = useState(false);
  const scrollRef = useRef<HTMLDivElement>(null);

  const onScroll = () => {
    const el = scrollRef.current;
    if (!el) return;
    const atBottom = el.scrollTop + el.clientHeight >= el.scrollHeight - 8; // жижиг buffer
    if (atBottom) setCanAccept(true);
  };

  const date = new Date().toISOString();

  return (
    <Dialog open={open} onOpenChange={setOpen}>
      <DialogTrigger asChild>
        <Button variant="link">Үйлчилгээний нөхцөл</Button>
      </DialogTrigger>
      <DialogContent className="max-w-2xl">
        <DialogHeader>
          <DialogTitle className="text-primary">
            Үйлчилгээний нөхцөл
          </DialogTitle>
        </DialogHeader>

        <div
          ref={scrollRef}
          onScroll={onScroll}
          className="h-72 overflow-y-auto rounded-md border p-4 space-y-3 text-sm leading-6 text-gray-700 text-justify"
        >
          <h5 className="font-semibold">
            Үйлчилгээний нөхцөл, нууцлалын бодлого{" "}
          </h5>
          <p>
            Энэхүү үйлчилгээний нөхцөл нь cab21.zakhzeel.mn цахим хуудсаар
            дамжуулан хэрэглэгчээс тодорхой мэдээлэл хүлээн авах, хадгалах,
            хамгаалах, мөн энэхүү нөхцөлд заасан зорилгоор ашиглахтай холбогдсон
            харилцааг зохицуулах эрх зүйн баримт бичиг болно.
          </p>
          <p>
            Хэрэглэгч “Зөвшөөрөх” товчийг дарснаар дараахтай сайн дураар, бүрэн
            ойлгож, хүлээн зөвшөөрсөнд тооцогдоно. Үүнд:
          </p>
          <p>Өгөгдөл цуглуулалт ба ашиглалт</p>
          <p>
            Хэрэглэгчийн бүртгэлийн болон хэрэглээний тодорхой мэдээлэл нь
            энэхүү нөхцөлд заасан зорилгоор цуглуулагдаж, хадгалагдаж,
            ашиглагдана.
          </p>
          <p>
            Хэрэглэгч зөвшөөрөх үйлдэл хийснээр энэхүү үйлчилгээний нөхцөлд
            заасан эрх, үүрэг, хязгаарлалт нь хэрэглэгч болон үйлчилгээ
            үзүүлэгчийн хооронд үүсэх бөгөөд энэхүү нөхцөл нь эрх зүйн хүчин
            төгөлдөр баримт бичиг гэж тооцогдоно.{" "}
          </p>
          <p>Эрхийн үр дагавар </p>
          <p>
            Үйлчилгээний нөхцлийг зөвшөөрсөнөөр хэрэглэгч нь түүний хэрэгжилтийг
            хангах үүрэг хүлээнэ.{" "}
          </p>
          <p>
            Үйлчилгээ үзүүлэгч нь хэрэглэгчийн мэдээллийг зөвхөн хууль болон
            энэхүү нөхцөлд нийцүүлэн ашиглах үүрэгтэй.Энэхүү үйлчилгээний нөхцөл
            нь “Globalsoft” ХХК-аас хэрэглэгчид санал болгож
            буй cab21.zakhzeel.mn веб хуудсаар дамжуулан хүргэж байгаа бүхий л
            үйлчилгээтэй холбоотой харилцааг шууд болон шууд бусаар зохицуулахад
            зориулагдсан болно.
          </p>
          <p>
            Энэхүү цахим хуудас, захиалгын систем, программ зэрэг хэрэглэгчид
            санал болгож буй бүхий л мэдээлэл үйлчилгээ нь “Globalsoft” ХХК-ийн
            өмч болно.{" "}
          </p>
          <ul>
            cab21.zakhzeel.mn-н үйлчилгээ, захиалгын систем дээр байршсан аливаа
            мэдээлэл, программ хангамж, захиалга гэх мэт бүтээгдэхүүн үйлчилгээг
            зөвшөөрөлгүйгээр хуулбарлан худалдах, дамлах зэрэг үйлдэл нь
            хориотой болно.
            <li>
              1. Та энэхүү үйлчилгээний нөхцлийг
              зөвшөөрснөөр cab21.zakhzeel.mn-д дараах зөвшөөрөл, эрхийг олгох
              болно.
            </li>
            <li>
              A. Таны үүсгэсэн, дамжуулсан хувийн мэдээллийг хүлээн авч
              хадгалах.
            </li>
            <li>
              B. Энэхүү үйлчилгээний нөхцөлд заасан журмын дагуу цуглуулсан
              мэдээллийг cab21.zakhzeel.mn-ээс үзүүлэх үйлчилгээний чанар,
              хүртээмжийг сайжруулах, шинэ бүтээгдэхүүн гаргахтай
              холбоотойгоор cab21.zakhzeel.mn-н дотоод хэрэгцээнд ашиглах.
            </li>
            <li>
              C. Энэхүү үйлчилгээний нөхцөлд заасан журмын дагуу цуглуулсан
              мэдээллийг cab21.zakhzeel.mn аппликейшн болон түүний хиймэл оюун
              ухааныг хөгжүүлэхэд ашиглах.
            </li>
            <li>
              2. Хэрэглэгч тус бүр үйлчилгээг cab21.zakhzeel.mn –ээр дамжуулан
              авсан тохиолдолд хариуцлагатай ёс суртахуунтай боловсон байдлаар
              үйлчилгээ авах үүрэгтэй.
            </li>
            <li>
              3. Хэрэглэгч нь хувийн болон эд хөрөнгийн аюулгүй байдлыг өөрсдөө
              бүрэн хангах үүрэгтэй.
            </li>
            <li>
              4. cab21.zakhzeel.mn нь таны үүсгэсэн, дамжуулсан хувийн болон
              санхүүгийн мэдээллийг энэхүү үйлчилгээний нөхцөлд зааснаас бусад
              зорилгоор ашиглах, бусдад задруулахгүй байх үүрэгтэй бөгөөд,
              мэдээллийн нууцлалыг хамгаалах үүрэг хүлээнэ.
            </li>
            <li>
              5. Хэрэглэгчийн мэдээллийг хуулийн дагуу эрх бүхий байгууллага
              шаардах, хамтран ажиллахаас бусдаар өөр ямар нэгэн гуравдагч
              этгээдэд задруулахгүй.
            </li>
            <li>
              6. Та cab21.zakhzeel.mn-нд хувийн болон санхүүгийн мэдээллээ
              үүсгэх, эсхүл дамжуулахдаа дараах үүрэг хүлээнэ:{" "}
            </li>
            <li>A. Хуурамч мэдээлэл оруулахгүй байх. </li>
            <li>B. Та хэрэглэгч үүсгэхдээ утасны дугаараар бүртгүүлнэ. </li>
            <li>
              C. Утасны дугаараар бүртгүүлснээр жолооч болон хэрэглэгч нар
              хоорондоо байршил болон нэгнээ таньж мэдэхэд хэрэглэгдэнэ.{" "}
            </li>
            <li>
              D. Утасны дугаар бүртгүүлснээр та үйлчилгээ авч байхдаа ямар нэгэн
              зүйл мартаж буухад жолооч танруу залгаж мэдэгдэхэд хэрэглэгдэнэ.{" "}
            </li>
            <li>
              E. Бусдын хувийн болон санхүүгийн мэдээллийг оруулахгүй байх.{" "}
            </li>
            <li>
              F. cab21.zakhzeel.mn-д нэвтрэх нэр, нууц үг болон цахим шуудангийн
              мэдээллээ бусдад дамжуулахгүй байх, үүнтэй холбоотой учирч болох
              аливаа эрсдэлээс сэргийлэх үүрэгтэй. Энэхүү үүргээ биелүүлээгүй
              буюу хангалтгүй биелүүлсэний улмаас учирсан аливаа хохирлыг
              “Globalsoft” ХХК хариуцахгүй болно.{" "}
            </li>
            <li>
              7. Хэрэв Та энэхүү Үйлчилгээний нөхцлийн 6.a-д заасныг зөрчин
              хуурамч мэдээлэл оруулсан бол cab21.zakhzeel.mn таны хэрэглэгчийн
              эрхээс татгалзах эрхтэй.
            </li>
            <li>
              8. Хэрэв Та энэхүү Үйлчилгээний нөхцөлд заасныг зөрчин бусдын нэр,
              хувийн болон санхүүгийн мэдээллийг ашигласан, эсхүл дамжуулсан бол
              cab21.zakhzeel.mn таны бүртгэлээс татгалзах эрхтэй бөгөөд Та
              өөрийн хууль бус үйлдлийн улмаас тухайн мэдээллийн өмчлөгч,
              эзэмшигч, cab21.zakhzeel.mn-д учруулсан аливаа гэм хор, хохирлыг
              бүрэн хариуцна.{" "}
            </li>
            <li>
              9. Хэрэглэгч өөрийн хүсэлтээр бүртгэлээ устгах эрхтэй бөгөөд
              хүсэлт өгсөнөөс 7 хоногийн дараа системээс автоматаар бүрэн
              устгагдана.
            </li>
            <li>
              10. cab21.zakhzeel.mn-н үйлчилгээг авахдаа та өдөр хоног, тодорхой
              цаг, хаана зэргийг сонгон хадгалснаар захиалга баталгаажна.{" "}
            </li>
            <li>
              A. Захиалга баталгаажсан тохиолдолд цуцлах боломжгүйг анхаарна уу.{" "}
            </li>
            <li>
              11. cab21.zakhzeel.mn-тэй холбогдох гомдол эсвэл үйлчилгээний
              талаарх санал хүсэлтээ албан ёсоор
              infocab21.zakhzeel@gmail.com цахим хаягаар илгээх ба ингэхдээ
              үйлчилгээ авснаас хойш ажлын 10 хоногт багтаан ирүүлнэ.{" "}
            </li>
            <li>
              A. Дээрх хугацаанд ирүүлээгүй аливаа санал, гомдлыг хүлээн авахгүй
              ба гомдол барагдуулах гэх мэт боломжгүйг анхаарна уу.
            </li>
            <li>
              B. Ирсэн санал гомдлыг бид ажлын 10 хоногт багтаан
              шийдвэрлэнэ. /Биднээс шалтгаалж байгаа тохиолдолд/
            </li>
            <li>
              12. Энэхүү үйлчилгээний нөхцөлд өөрчлөлт оруулж болох бөгөөд энэ
              тохиолдолд уг өөрчлөлтийн талаар “нийтлэгдсэн огноо”- оор
              илэрхийлж мэдэгдэнэ. Уг огноогоос хойш үйлчилгээ авч буй
              тохиолдолж хүлээн зөвшөөрсөнд тооцно.
            </li>
            <li>
              13. cab21.zakhzeel.mn нь таны мэдээллийн аюулгүй байдлыг хангах,
              cab21.zakhzeel.mn - нийг зүй бусаар, эсхүл хууль бус зорилгоор
              ашиглахаас урьдчилан сэргийлэх зорилгоор вэб сайтанд хандах
              хандалт, таны хийж байгаа аливаа үйлдлийн түүхийн лог болгон
              хадгалах, түүнийг хуулийн хүрээнд ашиглах эрхтэй.{" "}
            </li>
            <li>
              14. Та энэхүү үйлчилгээний нөхцлийг зөвшөөрч, cab21.zakhzeel.mn
              ашигласан нь та энэхүү үйлчилгээний нөхцөлд тусгайлан дурдсанаас
              бусад асуудлаар cab21.zakhzeel.mn-н эсрэг ямарваа нэг шаардлага
              гаргах эрхийг танд олгохгүй болно.
            </li>
            <li>
              15. Энэхүү үйлчилгээний нөхцөл нь Монгол улсын хуулиар хүлээн
              зөвшөөрөгдсөн цар хүрээ цар хүрээ, хэм хэмжээнд үйлчлэх ба аливаа
              маргааны үед талууд эвийн журмаар шийдвэрлэх бөгөөд тохиролцоонд
              хүрэхгүй тохиолдолд Монгол улсын хуулийн дагуу шийдвэрлэнэ.
            </li>
          </ul>

          <p className="text-center">Улаанбаатар хот {date.slice(0, 10)}</p>
        </div>

        <DialogFooter className="gap-2">
          <Button
            type="button"
            variant="secondary"
            onClick={() => setOpen(false)}
          >
            Хаах
          </Button>
          <Button
            type="button"
            disabled={!canAccept}
            onClick={() => {
              onAccept(); // parent → setValue('terms', true)
              setOpen(false); // close
            }}
          >
            Зөвшөөрөх
          </Button>
        </DialogFooter>
      </DialogContent>
    </Dialog>
  );
}
